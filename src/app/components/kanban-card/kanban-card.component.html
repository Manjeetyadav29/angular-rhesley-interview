<div class="kanban-card" [style.border-left-color]="getStatusColor()">
  @if (!isEditing) {
  <div class="card-header">
    <h4 class="card-title" (dblclick)="startEdit()">{{ task.title }}</h4>
    <button class="delete-button" (click)="deleteTask($event)" title="Delete task">
      <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
        <path d="M10.5 3.5L3.5 10.5M3.5 3.5L10.5 10.5" stroke="#ef4444" stroke-width="1.5" stroke-linecap="round" />
      </svg>
    </button>
  </div>
  } @else {
  <div class="edit-container">
    <input type="text" class="edit-input" [(ngModel)]="editedTitle" (keyup.enter)="saveEdit()"
      (keyup.escape)="cancelEdit()" autofocus>
    <div class="edit-actions">
      <button class="save-button" (click)="saveEdit()">Save</button>
      <button class="cancel-button" (click)="cancelEdit()">Cancel</button>
    </div>
  </div>
  }

  @if (!isEditing) {
  @if (task.description) {
  <p class="card-description">{{ task.description }}</p>
  }

  <div class="card-meta">
    <div class="meta-row">
      <span class="priority-badge" [style.background-color]="getPriorityColor()">
        {{ task.priority.toUpperCase() }}
      </span>

      @if (task.assignee) {
      <div class="assignee">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <circle cx="7" cy="4" r="2" stroke="#6b7280" stroke-width="1.2" />
          <path d="M3 12c0-2.2 1.8-4 4-4s4 1.8 4 4" stroke="#6b7280" stroke-width="1.2" stroke-linecap="round" />
        </svg>
        <span>{{ task.assignee }}</span>
      </div>
      }
    </div>

    <div class="card-footer">
      @if (task.dueDate) {
      <div class="due-date" [class.overdue]="isOverdue()">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <rect x="2" y="3" width="10" height="9" rx="1" stroke="currentColor" stroke-width="1.2" />
          <path d="M2 5h10M5 1v2M9 1v2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" />
        </svg>
        <span>{{ task.dueDate | date:'MMM d' }}</span>
      </div>
      }

      <div class="comments">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <path d="M12 7c0 2.8-2.2 5-5 5-.6 0-1.2-.1-1.7-.3L2 13l1.3-3.3C3.1 9.2 3 8.6 3 8c0-2.8 2.2-5 5-5s5 2.2 5 4z"
            stroke="#6b7280" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
        <span>{{ task.comments }}</span>
      </div>
    </div>
  </div>
  }
</div>